# 게임 모드 시스템

> V1.4.0 패치 - 게임 모드 및 AI 난이도 시스템

---

## 목차

1. [개요](#개요)
2. [AI 대전 모드](#ai-대전-모드)
3. [1vs1 대전 모드](#1vs1-대전-모드-설계)
4. [UI 흐름](#ui-흐름)

---

## 개요

게임 시작 전 게임 모드를 선택할 수 있습니다.

| 모드 | 상태 | 설명 |
|------|------|------|
| AI 대전 | 구현됨 | AI와 대전, 난이도 선택 가능 |
| 1vs1 대전 | 준비중 | 다른 플레이어와 실시간 대전 |

---

## AI 대전 모드

### 난이도 선택

AI 대전 시 3가지 난이도 중 하나를 선택할 수 있습니다.

| 난이도 | 추천 대상 | 특징 |
|--------|----------|------|
| 쉬움 | 초보자 | 느린 AI, 적은 자원 |
| 중간 | 일반 플레이어 | 균형 잡힌 플레이 |
| 어려움 | 숙련자 | 빠르고 공격적인 AI |

### 난이도별 상세 설정

#### 쉬움 (Easy)

| 항목 | 값 | 설명 |
|------|-----|------|
| 골드 수입 | 3/초 | 플레이어(4/초)보다 25% 적음 |
| 행동 주기 | 5초 | 의사결정 간격 |
| 행동 확률 | 60% | 턴마다 행동할 확률 |
| 지원 유닛 최소 | 3마리 | 유지하려는 지원 유닛 수 |
| 금광부 생산 확률 | 20% | 조건 충족 시 |
| 기사 생산 확률 | 25% | 조건 충족 시 |
| 궁수 생산 확률 | 30% | 조건 충족 시 |
| 초기 골드 | 100 | 게임 시작 시 |

**특징**:
- 느린 의사결정으로 대응 시간 충분
- 낮은 자원 수입으로 유닛 생산 느림
- 고급 유닛 생산 확률 낮음
- 초보자가 게임 시스템을 익히기 좋음

---

#### 중간 (Normal)

| 항목 | 값 | 설명 |
|------|-----|------|
| 골드 수입 | 4/초 | 플레이어와 동일 |
| 행동 주기 | 4초 | 더 빠른 의사결정 |
| 행동 확률 | 70% | 높아진 행동 확률 |
| 지원 유닛 최소 | 4마리 | 더 많은 자원 채집 |
| 금광부 생산 확률 | 30% | 증가 |
| 기사 생산 확률 | 35% | 증가 |
| 궁수 생산 확률 | 40% | 증가 |
| 초기 골드 | 100 | 동일 |

**특징**:
- 플레이어와 동등한 자원 수입
- 적극적인 유닛 생산
- 고급 유닛(기사, 궁수) 자주 등장
- 전략적 플레이 필요

---

#### 어려움 (Hard)

| 항목 | 값 | 설명 |
|------|-----|------|
| 골드 수입 | 5/초 | 플레이어보다 25% 많음 |
| 행동 주기 | 3초 | 매우 빠른 의사결정 |
| 행동 확률 | 85% | 거의 매 턴 행동 |
| 지원 유닛 최소 | 5마리 | 강력한 자원 수급 |
| 금광부 생산 확률 | 40% | 높음 |
| 기사 생산 확률 | 45% | 높음 |
| 궁수 생산 확률 | 50% | 높음 |
| 초기 골드 | 150 | 50 보너스 |

**특징**:
- 플레이어보다 유리한 자원 수입
- 빠른 의사결정으로 압박
- 고급 유닛 대량 생산
- 초기 골드 보너스로 빠른 시작
- 숙련된 전략과 빠른 대응 필요

---

### AI 의사결정 로직

AI는 다음 우선순위로 유닛을 생산합니다:

```
1. 지원 유닛이 최소 수보다 적으면 → 나무꾼 생산
2. 금광부가 없고 자원 충분하면 → 확률적으로 금광부 생산
3. 자원이 충분하면 → 확률적으로 기사 생산
4. 나무가 있으면 → 확률적으로 궁수 생산
5. 골드가 있으면 → 검병 생산
```

---

### 난이도별 예상 게임 양상

| 난이도 | 초반 (0~3분) | 중반 (3~7분) | 후반 (7~10분) |
|--------|-------------|-------------|---------------|
| 쉬움 | 느린 유닛 생산 | 검병 위주 | 소수 궁수 |
| 중간 | 적당한 속도 | 검병+궁수 혼합 | 기사 등장 |
| 어려움 | 빠른 유닛 생산 | 궁수 다수 | 기사 대량 투입 |

---

## 1vs1 대전 모드 (설계)

> 이 모드는 현재 설계 단계이며, 향후 패치에서 구현 예정입니다.

### 개요

실시간으로 다른 플레이어와 대전하는 모드입니다.

### 기술 스택

| 구성요소 | 기술 |
|---------|------|
| 서버 | Node.js |
| 통신 | WebSocket |
| 동기화 | 서버 권위 모델 |

### 아키텍처

```
┌─────────────┐     WebSocket      ┌─────────────┐
│  Player 1   │◄──────────────────►│   Server    │
│  (Browser)  │                    │  (Node.js)  │
└─────────────┘                    └──────┬──────┘
                                          │
                                          │ WebSocket
                                          ▼
                                   ┌─────────────┐
                                   │  Player 2   │
                                   │  (Browser)  │
                                   └─────────────┘
```

### 매칭 시스템

1. 플레이어가 "대전 찾기" 클릭
2. 매칭 대기열에 등록
3. 2명이 모이면 게임 방 생성
4. 카운트다운 후 게임 시작

### 게임 규칙

| 항목 | 값 |
|------|-----|
| 게임 시간 | 10분 |
| 양측 골드 수입 | 4/초 (동일) |
| 초기 자원 | 골드 100 (동일) |
| 승리 조건 | 적 기지 파괴 또는 시간 종료 시 HP 우위 |

### 동기화 전략

**서버 권위 모델**
- 모든 게임 로직은 서버에서 실행
- 클라이언트는 입력만 전송
- 치팅 방지

**상태 동기화**
- 전체 상태: 게임 시작 시
- 델타 업데이트: 100ms마다
- 중요 이벤트: 즉시 전송

### 통신 메시지

**클라이언트 → 서버**
| 메시지 | 설명 |
|--------|------|
| JOIN_QUEUE | 매칭 대기열 참가 |
| LEAVE_QUEUE | 매칭 취소 |
| SPAWN_UNIT | 유닛 생산 요청 |
| BUILD_WALL | 벽 건설 요청 |
| UPGRADE_BASE | 기지 업그레이드 요청 |
| SELL_HERB | 약초 판매 요청 |

**서버 → 클라이언트**
| 메시지 | 설명 |
|--------|------|
| QUEUE_STATUS | 대기열 위치 |
| MATCH_FOUND | 매칭 성공 |
| GAME_STATE | 전체 게임 상태 |
| GAME_UPDATE | 상태 변경분 |
| GAME_OVER | 게임 종료 결과 |

---

## UI 흐름

### 현재 (V1.3.x)

```
메인 메뉴 → [게임 시작] → 게임 화면
```

### 변경 후 (V1.4.0)

```
메인 메뉴 → [게임 시작] → 모드 선택
                              │
                              ├─ [AI 대전] → 난이도 선택 → 게임 화면
                              │                  │
                              │                  ├─ 쉬움
                              │                  ├─ 중간
                              │                  └─ 어려움
                              │
                              └─ [1vs1 대전] → (준비중)
```

---

## 다음 문서

- [게임플레이 가이드](./GAMEPLAY.md) - 기본 조작 및 전략
- [유닛 가이드](./UNITS.md) - 모든 유닛의 상세 정보
- [게임 밸런스](./BALANCE.md) - 수치 및 AI 분석
