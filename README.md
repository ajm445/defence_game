# 막아라! 무너트려라!

> 자원을 채집하고, 기지를 세우고, 적을 무너트려라!

실시간 전략(RTS) 게임으로, 자원을 수집하고 유닛을 생산하여 적 기지를 먼저 파괴하면 승리합니다.

**Version: 1.5.3**

---

## 게임 소개

10분 안에 적 기지를 파괴하세요! 자원을 채집하고, 유닛을 생산하고, 전략적으로 공격과 방어를 조율해야 합니다.

### 승리 조건
- 적 기지 HP를 0으로 만들면 **승리**
- 시간 종료 시 HP가 더 높으면 **승리**

### 패배 조건
- 내 기지 HP가 0이 되면 **패배**
- 시간 종료 시 적 HP가 더 높거나 같으면 **패배**

---

## 기술 스택

### 클라이언트

| 기술 | 버전 | 용도 |
|------|------|------|
| React | 19.x | UI 프레임워크 |
| TypeScript | 5.x | 타입 안정성 |
| Vite | 7.x | 빌드 도구 |
| Zustand | 5.x | 상태 관리 |
| Tailwind CSS | 4.x | 스타일링 |

### 서버 (멀티플레이어)

| 기술 | 버전 | 용도 |
|------|------|------|
| Node.js | 22.x | 런타임 |
| ws | 8.x | WebSocket 서버 |
| TypeScript | 5.x | 타입 안정성 |

---

## 설치 및 실행

### AI 대전 (싱글플레이어)

```bash
# 의존성 설치
npm install

# 개발 서버 실행
npm run dev

# 프로덕션 빌드
npm run build
```

### 1vs1 대전 (멀티플레이어)

```bash
# 전체 의존성 설치 (루트 + 서버)
npm install

# 서버 실행 (별도 터미널)
cd server
npm run dev

# 클라이언트 실행 (별도 터미널)
npm run dev
```

**플레이 방법:**
1. 한 플레이어가 "방 만들기" 클릭 → 초대 코드 생성
2. 초대 코드를 상대방에게 공유
3. 상대방이 초대 코드 입력 후 "입장" 클릭
4. 양쪽 플레이어 입장 후 게임 자동 시작

---

## 게임 플레이

### 자원

| 자원 | 아이콘 | 획득 방법 |
|------|--------|----------|
| 골드 | 금색 | 자동 획득 (4/초) / 금광부 (광산) |
| 나무 | 갈색 | 나무꾼 / 직접 채집 |
| 돌 | 회색 | 광부 / 직접 채집 |
| 약초 | 초록 | 채집꾼 / 직접 채집 |
| 수정 | 보라 | 채집꾼 (희귀) / 수정 노드 |

### 유닛

#### 전투 유닛

| 유닛 | 비용 | HP | 공격력 | 사거리 | 설명 |
|------|------|----|----|--------|------|
| 검병 | 50 골드 | 100 | 15 | 30 | 근접 전투 유닛 |
| 궁수 | 80 골드 + 10 나무 | 50 | 25 | 150 | 원거리 공격 유닛 |
| 기사 | 120 골드 + 20 나무 + 30 돌 | 250 | 30 | 35 | 강력한 근접 탱커 |

#### 지원 유닛

| 유닛 | 비용 | HP | 채집 속도 | 채집 자원 |
|------|------|----|----|----------|
| 나무꾼 | 30 골드 | 60 | 1.0 | 나무 |
| 광부 | 40 골드 + 5 나무 | 70 | 0.8 | 돌 |
| 채집꾼 | 35 골드 | 50 | 1.2 | 약초 (수정 확률) |
| 금광부 | 100 골드 + 20 나무 | 70 | 1.5 | 골드 (광산) |

### 건설

| 행동 | 비용 | 효과 |
|------|------|------|
| 벽 건설 | 20 나무 + 10 돌 | 방어벽 생성 (HP 200) |
| 기지 업그레이드 | 100 골드 + 50 돌 | 기지 HP +200 |

---

## 조작법

### 키보드

| 키 | 동작 |
|----|------|
| `WASD` / `방향키` | 카메라 이동 |
| `Space` | 본진으로 카메라 이동 |
| `ESC` | 메뉴로 돌아가기 |

### 마우스

| 동작 | 기능 |
|------|------|
| 좌클릭 (유닛) | 유닛 선택 |
| 좌클릭 (자원) | 직접 채집 (거리 제한) |
| 우클릭 드래그 | 카메라 이동 |
| 미니맵 클릭 | 해당 위치로 이동 |

---

## 프로젝트 구조

```
defence_game/
├── src/                      # 클라이언트 (React)
│   ├── components/           # React 컴포넌트
│   │   ├── canvas/          # 게임 렌더링 (GameCanvas, Minimap)
│   │   ├── common/          # 공통 컴포넌트 (Button, HPBar)
│   │   ├── screens/         # 화면 (MainMenu, LobbyScreen 등)
│   │   └── ui/              # UI 패널 (ResourceBar, UnitPanel 등)
│   ├── constants/           # 게임 설정 (config.ts)
│   ├── game/                # 게임 로직
│   │   ├── ai/              # 적 AI
│   │   ├── resources/       # 자원 노드 관리
│   │   └── units/           # 유닛 타입 및 동작
│   ├── hooks/               # 커스텀 훅 (게임 루프, 입력 처리)
│   ├── renderer/            # 캔버스 렌더링
│   ├── services/            # WebSocket 클라이언트
│   ├── stores/              # Zustand 상태 관리
│   ├── types/               # TypeScript 타입
│   └── utils/               # 유틸리티 함수
├── server/                   # 멀티플레이어 서버 (Node.js)
│   └── src/
│       ├── game/            # 서버 게임 로직 (GameRoom)
│       ├── room/            # 방 관리 (RoomManager)
│       ├── state/           # 서버 상태 관리
│       └── websocket/       # WebSocket 서버 및 메시지 핸들러
└── shared/                   # 공유 타입
    └── types/               # 네트워크 메시지 및 게임 타입
```

---

## 게임 밸런스

| 항목 | 값 |
|------|-----|
| 게임 시간 | 10분 |
| 맵 크기 | 3000 x 2000 |
| 기지 초기 HP | 1000 |
| 골드 자동 획득 | 4/초 (플레이어, AI 동일) |

### AI 난이도

| 난이도 | 행동 주기 | 행동 확률 | 적 기지 HP |
|--------|----------|----------|-----------|
| 쉬움 | 5초 | 60% | 1000 |
| 중간 | 3초 | 80% | 1200 |
| 어려움 | 2.5초 | 85% | 1500 |

---

## 버전 히스토리

### V1.5.3 (현재)
- 서버 상태 동기화 주기 최적화 (100ms → 50ms)
- 도움말 UI 가독성 대폭 개선
- 타이머 UI 고정 너비 적용 (크기 변동 방지)
- 타이머 프로그레스 바 제거
- 멀티플레이어 게임 종료 화면 간소화
  - HP 통계 숨김
  - 기지 파괴 메시지 제거

### V1.5.2
- 멀티플레이어 통신 지연 문제 해결
- 클라이언트 측 보간(interpolation) 시스템 추가
- 유닛 위치 부드러운 이동 처리
- 골드 수입 부드러운 증가 표시
- 타이머 부드러운 감소 처리
- 서버 상태 전송 주기 최적화 (500ms → 100ms)

### V1.5.1
- 멀티플레이어 실시간 상태 동기화 완료
- 초대 코드 기반 방 시스템 구현
- 진영 배정 시스템 (방장: 왼쪽, 참가자: 오른쪽)
- 멀티플레이어 전용 렌더링 시스템 추가
- 서버 상태 기반 UI 컴포넌트 연동

### V1.5.0
- 1vs1 네트워크 멀티플레이어 모드 기본 구조 추가
- WebSocket 기반 실시간 대전 서버 구현
- 서버 권위 모델로 게임 상태 동기화
- 모노레포 구조로 프로젝트 재구성 (client/server/shared)

### V1.4.0
- AI 난이도 시스템 추가 (쉬움/중간/어려움)
- 난이도별 적 기지 HP 차등 적용
- AI 채집꾼/광부 생산 기능 추가
- AI 약초 판매 기능 추가
- 게임 시간 단축 (20분 → 10분)
- 기사 스탯 조정 (HP 200→250, 공격력 25→30)

### V1.3.0
- 벽 배치 시스템 개선 (위치 선택 가능)
- 적 공격 유닛이 벽 공격 기능 추가
- AI 밸런스 조정 (골드 수급 3/초로 감소)
- 광부 이동 속도 증가 (1.0 → 1.2)

### V1.2.0
- 기사 유닛 추가 (120G + 20W + 30S, HP 200, 공격력 25)
- 광산 수 증가 (각 진영 4개, 총 8개)
- 광산 재생성 시간 단축 (120초 → 60초)
- 유닛 전투 시스템 개선 (채집 유닛 반격 기능)
- 공격 유닛이 모든 적 유닛 타겟팅

### V1.1.0
- 광산 자원 노드 추가 (각 진영 2개씩)
- 금광부 유닛 추가 (광산에서 골드 채집)
- AI 금광부 생산 로직 추가

### V1.0.0
- 기본 게임 시스템 구현
- 5종 유닛 (검병, 궁수, 나무꾼, 광부, 채집꾼)
- 5종 자원 (골드, 나무, 돌, 약초, 수정)
- 적 AI 시스템
- 벽 건설 및 기지 업그레이드
- 미니맵 및 카메라 시스템

---

## 알려진 문제

현재 알려진 문제 없음.

---

## 라이선스

MIT License
